<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <style>
        h1 {

            padding: 20px;
            background-color: #e94a54;
            color: white;
        }

        form {
            padding: 15px;
            border: 1px solid #e94a54;
        }

        .btn-primary,
        .btn-primary:hover {
            border-color: #e94a54;
            background-color: #e94a54;
        }

        .btn-primary,
        .btn-primary:active {
            border-color: #e94a54;
            background-color: #e94a54;
        }

        .btn-primary:not(:disabled):not(.disabled):active,
        .btn-primary:not(:disabled):not(.disabled).active,
        .show>.btn-primary.dropdown-toggle {
            color: #fff;
            border-color: white;
            background-color: #e94a54;
        }

        .btn-primary:not(:disabled):not(.disabled):active:focus,
        .btn-primary:not(:disabled):not(.disabled).active:focus,
        .show>.btn-primary.dropdown-toggle:focus {
            box-shadow: 0 0 0 0.2rem white;
            background-color: #e94a54;
        }


        .form-control:focus {
            border-color: #e94a54;
            box-shadow: 0 0 0 0.2rem #fff;
            display: inline;
        }

        img {
            width: 400px;
            padding: 10px;
            border-radius: 20px;
            border: 1px solid #e94a54;
            margin: 0 auto;
        }

        p {

            font-size: 20px;
            padding-bottom: 20px;

        }

        form {
            margin-bottom: 20px;
        }

        a {
            padding: 20px;
        }
    </style>


    <title>Survey</title>
</head>

<body>
    <div class="container">

        <div class="row">
            <div class="col">
                <h1>Survey Questions</h1>
            </div>
        </div>

        <div class="row">
            <div class="col">

                <form>
                    <div class="jumbotron">
                        <h3>About you</h3>
                        <div class="form-group">
                            <label for="name">Name (required)</label>
                            <input type="text" class="form-control" id="name" required>
                        </div>

                        <div class="form-group">
                            <label for="photo">Link to Photo Image (Required)</label>
                            <input type="text" class="form-control" id="photo" required>
                        </div>
                    </div>
                    <hr>

                    <h4>Question 1</h4>

                    <div class="form-group">
                        <label for="sel1">Your favorite movies are thrillers.</label>
                        <select class="form-control form-control form-control-sm" id="sel1" required>
                            <option></option>
                            <option>1 (Strongly Disagree)</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <hr>
                    <h4>Question 2</h4>
                    <div class="form-group">
                        <label for="sel2">You like walking under the rain.</label>
                        <select class="form-control form-control form-control-sm" id="sel2" required>
                            <option></option>
                            <option>1 (Strongly Disagree)</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <hr>
                    <h4>Question 3</h4>
                    <div class="form-group">
                        <label for="sel3">Reading is you favorite hobby.</label>
                        <select class="form-control form-control form-control-sm" id="sel3" required>
                            <option></option>
                            <option>1 (Strongly Disagree)</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <hr>
                    <h4>Question 4</h4>
                    <div class="form-group">
                        <label for="sel4">You like hiking.</label>
                        <select class="form-control form-control form-control-sm" id="sel4" required>
                            <option></option>
                            <option>1 (Strongly Disagree)</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 (Strongly Agree)</option>
                        </select>
                    </div>

                    <hr>
                    <h4>Question 5</h4>
                    <div class="form-group">
                        <label for="sel5">Your favorite food is fast food.</label>
                        <select class="form-control form-control form-control-sm" id="sel5" required>
                            <option></option>
                            <option>1 (Strongly Disagree)</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <hr>
                    <h4>Question 6</h4>
                    <div class="form-group">
                        <label for="sel6">You like music.</label>
                        <select class="form-control form-control form-control-sm" id="sel6" required>
                            <option></option>
                            <option>1 (Strongly Disagree)</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <hr>
                    <h4>Question 7</h4>
                    <div class="form-group">
                        <label for="sel7">Cats are your favorite pets.</label>
                        <select class="form-control form-control form-control-sm" id="sel7" required>
                            <option></option>
                            <option>1 (Strongly Disagree)</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 (Strongly Agree)</option>
                        </select>
                    </div>

                    <hr>
                    <h4>Question 8</h4>
                    <div class="form-group">
                        <label for="sel8">You work on weekends.</label>
                        <select class="form-control form-control form-control-sm" id="sel8" required>
                            <option></option>
                            <option>1 (Strongly Disagree)</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 (Strongly Agree)</option>
                        </select>
                    </div>

                    <hr>
                    <h4>Question 9</h4>
                    <div class="form-group">
                        <label for="sel9">You like cold weather.</label>
                        <select class="form-control form-control-sm" id="sel9" required>
                            <option></option>
                            <option>1 (Strongly Disagree)</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 (Strongly Agree)</option>
                        </select>
                    </div>

                    <hr>
                    <h4>Question 10</h4>
                    <div class="form-group">
                        <label for="sel10">You play computer games.</label>
                        <select class="form-control form-control-sm" id="sel10" required>
                            <option></option>
                            <option>1 (Strongly Disagree)</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <hr>
                    <button type="submit" class="btn btn-primary" id="add">Submit</button>
                </form>
                <a href="/api/friends">API Friends</a>
                <div class="modal fade" id="myModal" role="dialog">
                    <div class="modal-dialog">

                        <!-- Modal content-->
                        <div class="modal-content">
                            <div class="modal-header">

                                <h4 class="modal-title">Your Best Match</h4>
                            </div>
                            <div class="modal-body">

                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            </div>
                        </div>

                    </div>
                </div>



            </div>
        </div>
    </div>

    <script>

        var sum = [];

        $("#add").on("click", function (event) {
            event.preventDefault();
            $(".modal-body").empty();
            var valid = true;
            function f1() {

                if ($("#name").val() == "" || $("#photo").val() == "" ||
                    $("#sel1").val() == "" || $("#sel2").val() == ""
                    || $("#sel3").val() == "" || $("#sel4").val() == ""
                    || $("#sel5").val() == "" || $("#sel6").val() == ""
                    || $("#sel7").val() == "" || $("#sel7").val() == ""
                    || $("#sel8").val() == "" || $("#sel9").val() == "" || $("#sel10").val() == "") { valid = false; }
                return valid;

            }

            f1();
            if (valid) {

                var person = {
                    name: $("#name").val().trim(),
                    photo: $("#photo").val().trim(),
                    scores: [$("#sel1").val().substr(0, 1),
                    $("#sel2").val().substr(0, 1),
                    $("#sel3").val().substr(0, 1),
                    $("#sel4").val().substr(0, 1),
                    $("#sel5").val().substr(0, 1),
                    $("#sel6").val().substr(0, 1),
                    $("#sel7").val().substr(0, 1),
                    $("#sel8").val().substr(0, 1),
                    $("#sel9").val().substr(0, 1),
                    $("#sel10").val().substr(0, 1)
                    ]
                };
                //console.log(person);

                $.post("/api/friends", person, function () {
                    $("#name").val("");
                    $("#photo").val("");
                    $("#sel1").val("");
                    $("#sel2").val("");
                    $("#sel3").val("");
                    $("#sel4").val("");
                    $("#sel5").val("");
                    $("#sel6").val("");
                    $("#sel7").val("");
                    $("#sel8").val("");
                    $("#sel9").val("");
                    $("#sel10").val("");

                });

                $.get("api/friends", function (data) {

                    //console.log(data);
                    for (let i = 0; i < data.length - 1; i++) {
                        var s = 0;
                        {
                            for (let j = 0; j < data[i].scores.length; j++) { s += Math.abs(parseInt(person.scores[j]) - parseInt(data[i].scores[j])); }
                            sum.push(s);
                        }

                    }
                    console.log(sum);
                    var min = sum.indexOf(Math.min.apply(null, sum));

                    console.log(data[min].name);
                    sum = [];

                    $(".modal-body").append("<h4>" + data[min].name + "</h4>");
                    $(".modal-body").append("<img src='" + data[min].photo + "'>");

                    $("#myModal").modal("show");


                });
            }

            else { alert("Fill out all fields!"); }
        });


    </script>




</body>

</html>